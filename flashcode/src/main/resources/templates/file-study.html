<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Study Assortment</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.js"></script>
</head>
<body ng-app="myApp">

    <nav class="navbar navbar-expand-md bg-dark navbar-dark">
        <a class="navbar-brand" th:href="@{/assortments}">FlashCode</a>
    </nav>

    <div class="container mt-5" ng-controller="studyCtrl">
        <h1>Study Assortment: <span th:text="${assortment.title}"></span></h1>
        
        <div class="d-flex justify-content-between">
            <button class="btn btn-secondary" ng-click="previousCard()">Previous</button>
            <button class="btn btn-secondary" ng-click="nextCard()">Next</button>
        </div>
        
        <div class="mt-4">
            <div class="row">
                <div class="col-md-6">
                    <h2>{{ currentCard.question }}</h2>
                </div>
                <div class="col-md-6">
                    <p><strong>Approach:</strong> {{ currentCard.approach }}</p>
                    <p><strong>Code:</strong> <pre>{{ currentCard.code }}</pre></p>
                    <p><strong>Time Complexity:</strong> {{ currentCard.timeComplexity }}</p>
                    <p><strong>Space Complexity:</strong> {{ currentCard.spaceComplexity }}</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        var app = angular.module('myApp', []);
        app.controller('studyCtrl', function($scope, $http) {
            $scope.assortment = { 
                id: [[${assortment.id}]], 
                cards: [] 
            };
            $scope.currentCardIndex = 0;

            $scope.getCards = function() {
                $http.get('/api/v1/assortments/' + $scope.assortment.id)
                    .then(function(response) {
                        $scope.assortment.cards = response.data;
                        $scope.currentCard = $scope.assortment.cards[$scope.currentCardIndex];
                    }, function(error) {
                        console.error('Error fetching cards:', error);
                    });
            };

            $scope.getCards();

            $scope.previousCard = function() {
                if ($scope.currentCardIndex > 0) {
                    $scope.currentCardIndex--;
                    $scope.currentCard = $scope.assortment.cards[$scope.currentCardIndex];
                }
            };

            $scope.nextCard = function() {
                if ($scope.currentCardIndex < $scope.assortment.cards.length - 1) {
                    $scope.currentCardIndex++;
                    $scope.currentCard = $scope.assortment.cards[$scope.currentCardIndex];
                }
            };
        });
    </script>
</body>
</html>